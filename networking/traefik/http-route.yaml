---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: traefik-dashboard
  namespace: networking
spec:
  interval: 1h
  chart:
    spec:
      chart: raw
      version: v0.3.2
      sourceRef:
        kind: HelmRepository
        name: dysnix
        namespace: flux-system
  dependsOn:
    - name: traefik
  values:
    resources:
      - apiVersion: gateway.networking.k8s.io/v1beta1 
        kind: HTTPRoute
        metadata:
          name: traefik-dashboard
          namespace: networking
        spec:
          parentRefs:
            - name: traefik-production
              namespace: networking
          hostnames:
            - traefik.ant-podz.xyz
          rules:
            - matches:
                - path:
                    value: /dashboard
                - path:
                    value: /api
              backendRefs:
                - name: api@internal
                  kind: TraefikService
                  group: traefik.containo.us
