---
# yaml-language-server: disable-all
apiVersion: volsync.backube/v1alpha1
kind: ReplicationSource
metadata:
  name: &source test-app2-config
spec:
  sourcePVC: *source
  trigger:
    schedule: "0 * * * *"  # Hourly backups
  restic:
    repository: restic-test-app2-config
    copyMethod: Snapshot
    pruneIntervalDays: 14
    retain:
      daily: 7
      within: 14d
    capacity: 1Gi
    storageClassName: local-hostpath
    accessModes:
      - ReadWriteOnce
    moverSecurityContext:
      runAsUser: 1000
      runAsGroup: 1000
      fsGroup: 1000
    moverAffinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values: ["${node}"]
